// Generated by CoffeeScript 1.3.3
(function() {
  var GMap, module,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  module = angular.module("myApp.services", []);

  GMap = (function() {

    function GMap(options) {
      this.onCenterChanged = __bind(this.onCenterChanged, this);

      this.resizeMapEl = __bind(this.resizeMapEl, this);

      var addListener;
      this.rootScope = options.rootScope;
      this.navBarHeight = 40;
      this.win = $(window);
      this.mapEl = $("#map");
      this.mapTypes = {
        m: 'map',
        h: 'satelite'
      };
      this.mapEl.hide();
      this.currCenter = options.center;
      this.resizeMapEl();
      this.win.resize(this.resizeMapEl);
      this.map = new google.maps.Map(this.mapEl[0], {
        zoom: options.zoom,
        center: new google.maps.LatLng(options.center.lat, options.center.lng),
        mapTypeId: google.maps.MapTypeId.ROADMAP
      });
      addListener = google.maps.event.addListener;
      addListener(this.map, 'center_changed', this.onCenterChanged);
      this.rootScope.currCenter = this.currCenter;
    }

    GMap.prototype.resizeMapEl = function() {
      return this.mapEl.css('height', this.win.height() - this.navBarHeight);
    };

    GMap.prototype.onCenterChanged = function() {
      var center;
      center = this.map.getCenter();
      this.currCenter.lat = center.lat();
      this.currCenter.lng = center.lng();
      $('#crosshairlat').html(this.currCenter.lat);
      return $('#crosshairlng').html(this.currCenter.lng);
    };

    return GMap;

  })();

  module.factory("GoogleMap", function($rootScope, $location) {
    var SJO, initPosition, initZoom, mapOptions, rootScope;
    rootScope = $rootScope;
    SJO = {
      lat: 9.993552791991132,
      lng: -84.20888416469096
    };
    initPosition = SJO;
    initZoom = 16;
    mapOptions = {
      rootScope: rootScope,
      zoom: initZoom,
      mapType: 'm',
      center: {
        lat: initPosition.lat,
        lng: initPosition.lng
      }
    };
    return new GMap(mapOptions);
  });

}).call(this);
